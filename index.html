<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç·åˆæ•´ç†åˆ†ææƒ…å ± ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap');

  :root {
    --navy: #0a1628;
    --navy-mid: #122040;
    --navy-light: #1c3260;
    --accent: #1e5fad;
    --accent-bright: #2e7de8;
    --gold: #c9a84c;
    --red: #c0392b;

    /* 3ç¨®åˆ¥ã‚«ãƒ©ãƒ¼ */
    --c1: #1a4a7a;      /* ç·åˆæ•´ç†åˆ†ææƒ…å ± */
    --c1-bg: #e8f0f9;
    --c1-border: #1a4a7a;
    --c2: #1a6650;      /* æä¾›ç”¨ */
    --c2-bg: #e6f4ef;
    --c2-border: #1a6650;
    --c3: #5a3d8a;      /* å‘¨çŸ¥ç­‰ç”¨ */
    --c3-bg: #f0ecf8;
    --c3-border: #5a3d8a;

    --text: #1a1a2e;
    --text-mid: #4a4a6a;
    --text-light: #7a7a9a;
    --border: #d0d8e8;
    --bg-main: #f4f6fb;
    --bg-card: #ffffff;
    --shadow: 0 2px 12px rgba(10,22,40,0.10);
    --shadow-lg: 0 8px 32px rgba(10,22,40,0.15);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Noto Sans JP', sans-serif;
    background: var(--bg-main);
    color: var(--text);
    min-height: 100vh;
    font-size: 14px;
    line-height: 1.6;
  }

  /* ===== HEADER ===== */
  header {
    background: var(--navy);
    color: white;
    padding: 0;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 16px rgba(0,0,0,0.3);
  }
  .header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 28px;
    border-bottom: 1px solid rgba(255,255,255,0.08);
  }
  .header-logo {
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .header-emblem {
    width: 40px; height: 40px;
    background: var(--gold);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; font-weight: 700; color: var(--navy);
    letter-spacing: -1px;
    flex-shrink: 0;
  }
  .header-title h1 {
    font-size: 15px; font-weight: 700; letter-spacing: 0.05em;
    color: white;
  }
  .header-title p {
    font-size: 11px; color: rgba(255,255,255,0.5); letter-spacing: 0.08em;
    font-family: 'IBM Plex Mono', monospace;
    margin-top: 1px;
  }
  .header-user {
    display: flex; align-items: center; gap: 10px;
    font-size: 12px; color: rgba(255,255,255,0.7);
  }
  .badge-role {
    padding: 3px 10px;
    border-radius: 3px;
    font-size: 11px; font-weight: 700;
    letter-spacing: 0.05em;
    font-family: 'IBM Plex Mono', monospace;
  }
  .role-admin { background: var(--gold); color: var(--navy); }
  .role-provide { background: #1a6650; color: white; }
  .role-public { background: #5a3d8a; color: white; }

  /* ===== NAV ===== */
  nav {
    display: flex;
    align-items: center;
    gap: 0;
    padding: 0 28px;
    background: var(--navy-mid);
  }
  .nav-btn {
    background: none; border: none; cursor: pointer;
    color: rgba(255,255,255,0.6);
    padding: 11px 18px;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 13px; font-weight: 500;
    border-bottom: 2px solid transparent;
    transition: all 0.18s;
    display: flex; align-items: center; gap: 6px;
    white-space: nowrap;
  }
  .nav-btn:hover { color: white; }
  .nav-btn.active {
    color: var(--gold);
    border-bottom-color: var(--gold);
  }
  .nav-count {
    background: rgba(255,255,255,0.15);
    border-radius: 10px;
    padding: 1px 7px;
    font-size: 10px;
    font-family: 'IBM Plex Mono', monospace;
    min-width: 20px; text-align: center;
  }

  /* ===== LAYOUT ===== */
  .main-content {
    max-width: 1280px;
    margin: 0 auto;
    padding: 24px 28px;
  }
  .page { display: none; }
  .page.active { display: block; }

  /* ===== SECTION HEADERS ===== */
  .section-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 18px;
  }
  .section-title {
    font-size: 17px; font-weight: 700; color: var(--navy);
    display: flex; align-items: center; gap: 10px;
  }
  .section-title::before {
    content: '';
    display: block; width: 4px; height: 20px;
    background: var(--gold); border-radius: 2px;
  }

  /* ===== STATS ===== */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 14px;
    margin-bottom: 24px;
  }
  .stat-card {
    background: var(--bg-card);
    border-radius: 8px;
    padding: 16px 18px;
    box-shadow: var(--shadow);
    border-left: 4px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
  }
  .stat-card.c1 { border-left-color: var(--c1); }
  .stat-card.c2 { border-left-color: var(--c2); }
  .stat-card.c3 { border-left-color: var(--c3); }
  .stat-card.total { border-left-color: var(--gold); }
  .stat-label { font-size: 11px; color: var(--text-light); font-weight: 500; margin-bottom: 4px; }
  .stat-value { font-size: 28px; font-weight: 700; font-family: 'IBM Plex Mono', monospace; color: var(--navy); }
  .stat-icon { font-size: 26px; opacity: 0.18; }

  /* ===== FORM ===== */
  .form-card {
    background: var(--bg-card);
    border-radius: 10px;
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  .form-card-header {
    background: var(--navy);
    color: white;
    padding: 14px 22px;
    font-size: 13px; font-weight: 700; letter-spacing: 0.04em;
    display: flex; align-items: center; gap: 8px;
  }
  .form-body { padding: 24px 22px; }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  .form-group { display: flex; flex-direction: column; gap: 5px; }
  .form-group.full { grid-column: 1 / -1; }
  label {
    font-size: 12px; font-weight: 700;
    color: var(--text-mid); letter-spacing: 0.04em;
  }
  label .required { color: var(--red); margin-left: 3px; }
  input[type=text], input[type=date], select, textarea {
    border: 1.5px solid var(--border);
    border-radius: 5px;
    padding: 8px 11px;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 13px;
    color: var(--text);
    background: white;
    transition: border-color 0.15s;
    outline: none;
  }
  input[type=text]:focus, input[type=date]:focus, select:focus, textarea:focus {
    border-color: var(--accent-bright);
    box-shadow: 0 0 0 3px rgba(46,125,232,0.12);
  }
  textarea { resize: vertical; min-height: 80px; }
  select { cursor: pointer; }

  /* åˆ†é¡é¸æŠãƒœã‚¿ãƒ³ */
  .category-selector {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
  }
  .cat-btn {
    border: 2px solid var(--border);
    border-radius: 7px;
    padding: 12px 10px;
    cursor: pointer;
    background: white;
    text-align: left;
    transition: all 0.15s;
    font-family: 'Noto Sans JP', sans-serif;
  }
  .cat-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow); }
  .cat-btn.selected-c1 { border-color: var(--c1); background: var(--c1-bg); }
  .cat-btn.selected-c2 { border-color: var(--c2); background: var(--c2-bg); }
  .cat-btn.selected-c3 { border-color: var(--c3); background: var(--c3-bg); }
  .cat-btn-label {
    font-size: 11px; font-weight: 700; letter-spacing: 0.03em;
    margin-bottom: 3px;
  }
  .cat-btn-desc { font-size: 10px; color: var(--text-light); line-height: 1.4; }
  .cat-btn.c1 .cat-btn-label { color: var(--c1); }
  .cat-btn.c2 .cat-btn-label { color: var(--c2); }
  .cat-btn.c3 .cat-btn-label { color: var(--c3); }

  /* åˆ†é¡ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
  .classification-indicator {
    display: flex; align-items: center; gap: 8px;
    padding: 10px 14px;
    border-radius: 6px;
    font-size: 12px; font-weight: 700;
    margin-top: 6px;
    transition: all 0.2s;
  }
  .ci-c1 { background: var(--c1-bg); color: var(--c1); border: 1.5px solid var(--c1-border); }
  .ci-c2 { background: var(--c2-bg); color: var(--c2); border: 1.5px solid var(--c2-border); }
  .ci-c3 { background: var(--c3-bg); color: var(--c3); border: 1.5px solid var(--c3-border); }
  .ci-none { background: #f4f4f8; color: #999; border: 1.5px dashed #ccc; }

  /* ===== BUTTONS ===== */
  .btn {
    padding: 9px 20px; border-radius: 5px; border: none; cursor: pointer;
    font-family: 'Noto Sans JP', sans-serif; font-size: 13px; font-weight: 700;
    letter-spacing: 0.03em; transition: all 0.15s; display: inline-flex;
    align-items: center; gap: 6px;
  }
  .btn-primary { background: var(--accent); color: white; }
  .btn-primary:hover { background: var(--accent-bright); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(30,95,173,0.3); }
  .btn-secondary { background: white; color: var(--text-mid); border: 1.5px solid var(--border); }
  .btn-secondary:hover { background: var(--bg-main); }
  .btn-danger { background: var(--red); color: white; }
  .btn-danger:hover { opacity: 0.88; }
  .btn-sm { padding: 5px 12px; font-size: 12px; }
  .form-actions {
    display: flex; gap: 10px; justify-content: flex-end;
    margin-top: 22px; padding-top: 18px;
    border-top: 1px solid var(--border);
  }

  /* ===== SEARCH / FILTER BAR ===== */
  .filter-bar {
    background: var(--bg-card);
    border-radius: 8px;
    padding: 14px 18px;
    box-shadow: var(--shadow);
    margin-bottom: 16px;
    display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
  }
  .search-box {
    flex: 1; min-width: 220px;
    position: relative;
  }
  .search-box input {
    width: 100%;
    padding-left: 34px;
  }
  .search-icon {
    position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
    color: var(--text-light); font-size: 14px; pointer-events: none;
  }
  .filter-select { min-width: 150px; }
  .filter-label { font-size: 12px; font-weight: 700; color: var(--text-mid); white-space: nowrap; }

  /* ===== TABLE ===== */
  .table-wrap {
    background: var(--bg-card);
    border-radius: 10px;
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  table {
    width: 100%; border-collapse: collapse;
  }
  thead tr {
    background: var(--navy);
    color: white;
  }
  th {
    padding: 11px 14px;
    font-size: 11px; font-weight: 700; letter-spacing: 0.06em;
    text-align: left; white-space: nowrap;
    cursor: pointer;
    user-select: none;
  }
  th:hover { background: var(--navy-light); }
  tbody tr {
    border-bottom: 1px solid var(--border);
    transition: background 0.1s;
  }
  tbody tr:last-child { border-bottom: none; }
  tbody tr:hover { background: #f0f4fb; }
  td {
    padding: 11px 14px;
    font-size: 13px;
    vertical-align: middle;
  }

  /* ç¨®åˆ¥ãƒãƒƒã‚¸ */
  .badge {
    display: inline-flex; align-items: center; gap: 4px;
    padding: 3px 9px; border-radius: 4px;
    font-size: 10px; font-weight: 700; letter-spacing: 0.04em;
    white-space: nowrap;
    font-family: 'IBM Plex Mono', monospace;
  }
  .badge-c1 { background: var(--c1-bg); color: var(--c1); border: 1px solid var(--c1-border); }
  .badge-c2 { background: var(--c2-bg); color: var(--c2); border: 1px solid var(--c2-border); }
  .badge-c3 { background: var(--c3-bg); color: var(--c3); border: 1px solid var(--c3-border); }

  /* è„…å¨ãƒ¬ãƒ™ãƒ« */
  .threat-dot {
    display: inline-block; width: 8px; height: 8px; border-radius: 50%;
    margin-right: 5px;
  }
  .threat-critical { background: #c0392b; }
  .threat-high { background: #e67e22; }
  .threat-medium { background: #f1c40f; }
  .threat-low { background: #27ae60; }

  .no-data {
    text-align: center; padding: 48px; color: var(--text-light);
    font-size: 13px;
  }

  /* ===== ACCESS CONTROL ===== */
  .access-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
    margin-bottom: 20px;
  }
  .access-card {
    background: var(--bg-card);
    border-radius: 10px;
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  .access-card-header {
    padding: 12px 16px;
    font-size: 12px; font-weight: 700; letter-spacing: 0.04em;
    color: white;
  }
  .ach-c1 { background: var(--c1); }
  .ach-c2 { background: var(--c2); }
  .ach-c3 { background: var(--c3); }
  .access-card-body { padding: 14px 16px; }
  .access-rule {
    display: flex; align-items: center; gap: 8px;
    padding: 6px 0; border-bottom: 1px solid var(--border); font-size: 12px;
  }
  .access-rule:last-child { border-bottom: none; }
  .access-allow { color: #27ae60; font-size: 14px; }
  .access-deny  { color: #c0392b; font-size: 14px; }
  .access-provision { font-size: 12px; font-weight: 700; }

  /* ===== DETAIL MODAL ===== */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(10,22,40,0.65);
    z-index: 200; align-items: center; justify-content: center;
    backdrop-filter: blur(3px);
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: white; border-radius: 12px; width: 680px; max-width: 95vw;
    max-height: 90vh; overflow-y: auto;
    box-shadow: var(--shadow-lg);
    animation: modalIn 0.2s ease;
  }
  @keyframes modalIn {
    from { transform: translateY(-16px) scale(0.98); opacity: 0; }
    to   { transform: translateY(0) scale(1); opacity: 1; }
  }
  .modal-header {
    padding: 18px 22px;
    background: var(--navy);
    color: white;
    display: flex; align-items: flex-start; justify-content: space-between;
  }
  .modal-body { padding: 22px; }
  .modal-close {
    background: none; border: none; color: rgba(255,255,255,0.6);
    font-size: 22px; cursor: pointer; line-height: 1; margin-top: -2px;
    transition: color 0.15s;
  }
  .modal-close:hover { color: white; }
  .detail-row {
    display: flex; gap: 12px; margin-bottom: 12px;
    padding-bottom: 12px; border-bottom: 1px solid var(--border);
    font-size: 13px;
  }
  .detail-row:last-child { border-bottom: none; margin-bottom: 0; }
  .detail-key {
    flex: 0 0 130px; font-weight: 700; color: var(--text-mid); font-size: 12px;
  }
  .detail-val { flex: 1; color: var(--text); }

  /* ===== TOAST ===== */
  .toast {
    position: fixed; bottom: 24px; right: 24px;
    background: var(--navy); color: white;
    padding: 12px 20px; border-radius: 8px;
    font-size: 13px; font-weight: 500;
    box-shadow: var(--shadow-lg);
    z-index: 300;
    display: flex; align-items: center; gap: 8px;
    transform: translateY(80px); opacity: 0;
    transition: all 0.25s ease;
    max-width: 360px;
  }
  .toast.show { transform: translateY(0); opacity: 1; }
  .toast.success { background: #1a6650; }
  .toast.error   { background: var(--red); }

  /* ===== PAGINATION ===== */
  .pagination {
    display: flex; align-items: center; justify-content: space-between;
    padding: 12px 16px;
    background: var(--bg-main);
    border-top: 1px solid var(--border);
    font-size: 12px; color: var(--text-light);
  }
  .page-btns { display: flex; gap: 4px; }
  .page-btn {
    padding: 4px 10px; border-radius: 4px; border: 1.5px solid var(--border);
    background: white; cursor: pointer; font-size: 12px; color: var(--text-mid);
    transition: all 0.12s;
  }
  .page-btn:hover, .page-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
  .page-btn:disabled { opacity: 0.4; cursor: not-allowed; }

  /* æ¨©é™ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ */
  .role-selector-wrap {
    background: var(--bg-card); border-radius: 8px;
    padding: 12px 18px; margin-bottom: 18px;
    display: flex; align-items: center; gap: 14px;
    box-shadow: var(--shadow);
  }
  .role-selector-wrap label { font-size: 12px; font-weight: 700; color: var(--text-mid); white-space: nowrap; }

  /* ===== åŠ å·¥ãƒ¡ãƒ¢ãƒ»åŠ å·¥å±¥æ­´ ===== */
  .process-timeline {
    position: relative;
    padding-left: 20px;
    margin-top: 4px;
  }
  .process-timeline::before {
    content: '';
    position: absolute; left: 7px; top: 6px; bottom: 6px;
    width: 2px; background: var(--border);
  }
  .process-step {
    position: relative;
    margin-bottom: 14px;
  }
  .process-step:last-child { margin-bottom: 0; }
  .process-dot {
    position: absolute; left: -17px; top: 4px;
    width: 10px; height: 10px; border-radius: 50%;
    border: 2px solid white;
    box-shadow: 0 0 0 2px var(--border);
  }
  .dot-c1 { background: var(--c1); box-shadow: 0 0 0 2px var(--c1); }
  .dot-c2 { background: var(--c2); box-shadow: 0 0 0 2px var(--c2); }
  .dot-c3 { background: var(--c3); box-shadow: 0 0 0 2px var(--c3); }
  .dot-pending { background: #ccc; box-shadow: 0 0 0 2px #ccc; }
  .process-step-header {
    display: flex; align-items: center; gap: 8px;
    margin-bottom: 4px;
  }
  .process-step-label {
    font-size: 11px; font-weight: 700; letter-spacing: 0.04em;
  }
  .process-step-date {
    font-size: 10px; color: var(--text-light);
    font-family: 'IBM Plex Mono', monospace;
  }
  .process-memo {
    font-size: 12px; color: var(--text-mid);
    background: var(--bg-main);
    border-radius: 5px;
    padding: 7px 10px;
    border-left: 3px solid var(--border);
    white-space: pre-wrap;
    line-height: 1.6;
  }
  .process-memo.memo-c1 { border-left-color: var(--c1); }
  .process-memo.memo-c2 { border-left-color: var(--c2); }
  .process-memo.memo-c3 { border-left-color: var(--c3); }
  .process-pending {
    font-size: 12px; color: var(--text-light);
    font-style: italic;
    padding: 4px 0;
  }
  .memo-section-title {
    font-size: 11px; font-weight: 700; color: var(--text-mid);
    letter-spacing: 0.04em; margin-bottom: 8px;
    display: flex; align-items: center; gap: 6px;
  }
  .memo-section-title::before {
    content: ''; display: block;
    width: 3px; height: 13px;
    background: var(--gold); border-radius: 2px;
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 900px) {
    .stats-row { grid-template-columns: repeat(2, 1fr); }
    .access-grid { grid-template-columns: 1fr; }
    .form-grid { grid-template-columns: 1fr; }
    .category-selector { grid-template-columns: 1fr; }
  }
  @media (max-width: 600px) {
    /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .main-content { padding: 10px; }
    .header-top { padding: 10px 12px; flex-wrap: wrap; gap: 8px; }
    .header-title h1 { font-size: 12px; }
    .header-title p { display: none; }
    .header-user span:first-child { display: none; }

    /* ãƒŠãƒ“ */
    nav { padding: 0 4px; overflow-x: auto; gap: 0; }
    .nav-btn { padding: 10px 10px; font-size: 12px; white-space: nowrap; }

    /* çµ±è¨ˆã‚«ãƒ¼ãƒ‰ */
    .stats-row { grid-template-columns: repeat(2, 1fr); gap: 8px; }
    .stat-value { font-size: 22px; }
    .stat-icon { font-size: 20px; }

    /* ãƒ†ãƒ¼ãƒ–ãƒ«ï¼šæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ */
    .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    table { min-width: 480px; }
    td, th { padding: 8px 10px; font-size: 12px; }

    /* ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æœ€æ–°æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«ã‚‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ */
    #page-dashboard .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    #page-dashboard table { min-width: 460px; }
    #page-dashboard td, #page-dashboard th { white-space: nowrap; }

    /* table-wrap ã‚’ç¢ºå®Ÿã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹ */
    .table-wrap { display: block; overflow-x: auto !important; }
    .form-card { overflow: visible; }

    /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒ¼ */
    .filter-bar { flex-direction: column; align-items: stretch; gap: 8px; }
    .search-box { min-width: unset; }
    .filter-label { display: none; }
    .filter-select { width: 100%; }

    /* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */
    .pagination { flex-direction: column; gap: 6px; align-items: flex-start; }

    /* ãƒ•ã‚©ãƒ¼ãƒ  */
    .form-body { padding: 14px; }
    .form-actions { flex-direction: column; }
    .form-actions .btn { width: 100%; justify-content: center; }

    /* æ¨©é™ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ */
    .role-selector-wrap { flex-wrap: wrap; gap: 8px; }
    .role-selector-wrap select { width: 100%; }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼šä¸‹ã‹ã‚‰å‡ºã‚‹ã‚·ãƒ¼ãƒˆå½¢å¼ã« */
    .modal { width: 100%; max-width: 100vw; border-radius: 12px 12px 0 0; margin-top: auto; max-height: 85vh; }
    .modal-overlay { align-items: flex-end; }
    .detail-row { flex-direction: column; gap: 4px; }
    .detail-key { flex: none; }

    /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .section-header { flex-wrap: wrap; gap: 8px; }
  }
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header>
  <div class="header-top">
    <div class="header-logo">
      <div class="header-emblem">ç·åˆæƒ…å ±</div>
      <div class="header-title">
        <h1>ç·åˆæ•´ç†åˆ†ææƒ…å ± ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
        <p>ã‚µã‚¤ãƒãƒ¼å¯¾å‡¦èƒ½åŠ›å¼·åŒ–æ³• åŸºæœ¬æ–¹é‡å¯¾å¿œ / CAO-CSEC-INFO v1.0</p>
      </div>
    </div>
    <div class="header-user">
      <span id="user-label">ç®¡ç†è€…ï¼ˆã‚µã‚¤ãƒãƒ¼å®‰å…¨ä¿éšœæ‹…å½“ï¼‰</span>
      <span class="badge-role role-admin" id="role-badge">ADMIN</span>
    </div>
  </div>
  <nav>
    <button class="nav-btn active" onclick="showPage('dashboard')" id="nav-dashboard">ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</button>
    <button class="nav-btn" onclick="showPage('register')" id="nav-register">âœï¸ æƒ…å ±ç™»éŒ²</button>
    <button class="nav-btn" onclick="showPage('list')" id="nav-list">
      ğŸ“‹ æƒ…å ±ä¸€è¦§ <span class="nav-count" id="count-badge">0</span>
    </button>
    <button class="nav-btn" onclick="showPage('access')" id="nav-access">ğŸ”’ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</button>
  </nav>
</header>

<!-- ===== MAIN ===== -->
<div class="main-content">

  <!-- ===== DASHBOARD ===== -->
  <div class="page active" id="page-dashboard">
    <div class="stats-row">
      <div class="stat-card total">
        <div>
          <div class="stat-label">ç™»éŒ²æƒ…å ± åˆè¨ˆ</div>
          <div class="stat-value" id="stat-total">0</div>
        </div>
        <div class="stat-icon">ğŸ“</div>
      </div>
      <div class="stat-card c1">
        <div>
          <div class="stat-label">ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
          <div class="stat-value" id="stat-c1">0</div>
        </div>
        <div class="stat-icon">ğŸ”µ</div>
      </div>
      <div class="stat-card c2">
        <div>
          <div class="stat-label">æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
          <div class="stat-value" id="stat-c2">0</div>
        </div>
        <div class="stat-icon">ğŸŸ¢</div>
      </div>
      <div class="stat-card c3">
        <div>
          <div class="stat-label">å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
          <div class="stat-value" id="stat-c3">0</div>
        </div>
        <div class="stat-icon">ğŸŸ£</div>
      </div>
    </div>

    <!-- æœ€æ–°æƒ…å ± -->
    <div class="section-header">
      <div class="section-title">æœ€æ–°ç™»éŒ²æƒ…å ±</div>
      <button class="btn btn-secondary btn-sm" onclick="showPage('list')">ä¸€è¦§ã‚’è¦‹ã‚‹ â†’</button>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>ç®¡ç†ç•ªå·</th>
            <th>ä»¶å</th>
            <th>ç¨®åˆ¥</th>
            <th>è„…å¨ãƒ¬ãƒ™ãƒ«</th>
            <th>ç™»éŒ²æ—¥</th>
          </tr>
        </thead>
        <tbody id="dashboard-tbody"></tbody>
      </table>
    </div>
  </div>

  <!-- ===== REGISTER ===== -->
  <div class="page" id="page-register">
    <div class="section-header">
      <div class="section-title">æƒ…å ±ç™»éŒ²</div>
    </div>
    <div class="form-card">
      <div class="form-card-header">ğŸ“ æ–°è¦æƒ…å ±ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ </div>
      <div class="form-body">
        <div class="form-grid">
          <div class="form-group">
            <label>ä»¶å<span class="required">*</span></label>
            <input type="text" id="f-title" placeholder="ä¾‹ï¼šã€‡ã€‡çœã‚·ã‚¹ãƒ†ãƒ ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥">
          </div>
          <div class="form-group">
            <label>æƒ…å ±æº</label>
            <input type="text" id="f-source" placeholder="ä¾‹ï¼šç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…å ±å‘Šãƒ»NISCãƒ»é€šä¿¡æƒ…å ±">
          </div>
          <div class="form-group">
            <label>è„…å¨ãƒ¬ãƒ™ãƒ«<span class="required">*</span></label>
            <select id="f-threat">
              <option value="">â€” é¸æŠ â€”</option>
              <option value="critical">ğŸ”´ é‡å¤§ (Critical)</option>
              <option value="high">ğŸŸ  é«˜ (High)</option>
              <option value="medium">ğŸŸ¡ ä¸­ (Medium)</option>
              <option value="low">ğŸŸ¢ ä½ (Low)</option>
            </select>
          </div>
          <div class="form-group">
            <label>æ”»æ’ƒç¨®åˆ¥</label>
            <select id="f-attack">
              <option value="">â€” é¸æŠ â€”</option>
              <option value="apt">APT (å›½å®¶æ”¯æ´å‹)</option>
              <option value="ransomware">ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢</option>
              <option value="ddos">DDoS</option>
              <option value="phishing">ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°</option>
              <option value="supply-chain">ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æ”»æ’ƒ</option>
              <option value="vuln">è„†å¼±æ€§æ‚ªç”¨</option>
              <option value="other">ãã®ä»–</option>
            </select>
          </div>
          <div class="form-group">
            <label>å¯¾è±¡æ¥­ç¨®</label>
            <input type="text" id="f-sector" placeholder="ä¾‹ï¼šé›»åŠ›ãƒ»é€šä¿¡ãƒ»é‡‘èãƒ»æ”¿åºœæ©Ÿé–¢">
          </div>
          <div class="form-group">
            <label>ç™ºç”Ÿ/æ¤œçŸ¥æ—¥</label>
            <input type="date" id="f-date">
          </div>
          <div class="form-group full">
            <label>æ¦‚è¦ãƒ»è©³ç´°<span class="required">*</span></label>
            <textarea id="f-summary" rows="4" placeholder="ã‚µã‚¤ãƒãƒ¼ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®è©³ç´°ã€æ”»æ’ƒæ‰‹æ³•ã€å½±éŸ¿ç¯„å›²ç­‰ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚"></textarea>
          </div>
          <div class="form-group full">
            <label>æŠ€è¡“çš„è©³ç´°ãƒ»IOC (Indicators of Compromise)</label>
            <textarea id="f-ioc" rows="3" placeholder="IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ãƒãƒƒã‚·ãƒ¥å€¤ã€CVEç•ªå·ç­‰"></textarea>
          </div>
          <div class="form-group full">
            <label>æ¨å¥¨å¯¾ç­–</label>
            <textarea id="f-countermeasure" rows="2" placeholder="æ¨å¥¨ã™ã‚‹å¯¾ç­–ãƒ»ç·©å’Œç­–"></textarea>
          </div>

          <!-- åŠ å·¥ãƒ¡ãƒ¢ -->
          <div class="form-group full">
            <label>âœ‚ï¸ åŠ å·¥ãƒ¡ãƒ¢
              <span style="font-weight:400;color:var(--text-light);font-size:11px;margin-left:6px;">
                ï¼ˆä½•ã‚’å‰Šé™¤ãƒ»è¨€ã„æ›ãˆã—ã¦ã“ã®ç¨®åˆ¥ã«ã—ãŸã‹ã€‚åŠ å·¥åˆ¤æ–­ã®æ ¹æ‹ ã¨ã—ã¦è¨˜éŒ²ï¼‰
              </span>
            </label>
            <textarea id="f-memo-c1" rows="2" placeholder="ã€ç·åˆâ†’æä¾›ç”¨ã¸ã®åŠ å·¥ã€‘ä¾‹ï¼šé¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ï¼ˆå‚å—ç”±æ¥ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ­ã‚°ï¼‰ã‚’é™¤å¤–ã€‚æ”»æ’ƒè€…è­˜åˆ¥æƒ…å ±ã‚’ã€Œå›½å®¶æ”¯æ´å‹ã‚°ãƒ«ãƒ¼ãƒ—ã€ã«æŠ½è±¡åŒ–ã€‚"></textarea>
            <textarea id="f-memo-c2" rows="2" placeholder="ã€æä¾›ç”¨â†’å‘¨çŸ¥ç­‰ç”¨ã¸ã®åŠ å·¥ã€‘ä¾‹ï¼šå…·ä½“çš„ãªIOCï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»ãƒãƒƒã‚·ãƒ¥å€¤ï¼‰ã‚’å‰Šé™¤ã€‚ã€Œç‰¹å®šè¨­å‚™ã«å½±éŸ¿ã€â†’ã€Œé‡è¦ã‚¤ãƒ³ãƒ•ãƒ©å…¨èˆ¬ã¸ã®æ³¨æ„å–šèµ·ã€ã«å¤‰æ›´ã€‚" style="margin-top:6px;"></textarea>
          </div>

          <!-- ç¨®åˆ¥åˆ†é¡ -->
          <div class="form-group full">
            <label>æƒ…å ±ç¨®åˆ¥ã®åˆ†é¡<span class="required">*</span>
              <span style="font-weight:400;color:var(--text-light);font-size:11px;margin-left:6px;">
                ï¼ˆæ³•ç¬¬72æ¡ã«åŸºã¥ãåŒºåˆ†ï¼‰
              </span>
            </label>
            <div class="category-selector" style="margin-top:8px;">
              <button type="button" class="cat-btn c1" id="catbtn-c1" onclick="selectCategory('c1')">
                <div class="cat-btn-label">ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
                <div class="cat-btn-desc">é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ã‚’å«ã‚€ç§˜åŒ¿æ€§ã®é«˜ã„æƒ…å ±ã€‚è¡Œæ”¿æ©Ÿé–¢ç­‰ãƒ»å¤–å›½æ”¿åºœãƒ»å”è­°ä¼šæ§‹æˆå“¡ã¸ã®æä¾›å¯¾è±¡ã€‚</div>
              </button>
              <button type="button" class="cat-btn c2" id="catbtn-c2" onclick="selectCategory('c2')">
                <div class="cat-btn-label">æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
                <div class="cat-btn-desc">é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ã‚’å«ã¾ãªã„åŠ å·¥ç‰ˆã€‚ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ãƒ»å”è­°ä¼šæ§‹æˆå“¡ç­‰ã¸ã®æä¾›å¯¾è±¡ã€‚</div>
              </button>
              <button type="button" class="cat-btn c3" id="catbtn-c3" onclick="selectCategory('c3')">
                <div class="cat-btn-label">å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
                <div class="cat-btn-desc">ç§˜å¯†ã‚’å«ã¾ãªã„åŠ å·¥ç‰ˆã€‚é›»å­è¨ˆç®—æ©Ÿä½¿ç”¨è€…ãƒ»ä¸€èˆ¬ã‚¤ãƒ³ãƒ•ãƒ©äº‹æ¥­è€…ç­‰ã¸ã®åºƒç¯„ãªå‘¨çŸ¥ãƒ»æä¾›å¯¾è±¡ã€‚</div>
              </button>
            </div>
            <div class="classification-indicator ci-none" id="cat-indicator" style="margin-top:10px;">
              â† ç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
        </div><!-- /form-grid -->

        <div class="form-actions">
          <button class="btn btn-secondary" onclick="resetForm()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
          <button class="btn btn-primary" onclick="submitForm()">ğŸ’¾ ç™»éŒ²ã™ã‚‹</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== LIST ===== -->
  <div class="page" id="page-list">
    <!-- é–²è¦§æ¨©é™ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ -->
    <div class="role-selector-wrap">
      <label>ğŸ”‘ é–²è¦§æ¨©é™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼š</label>
      <select onchange="changeViewRole(this.value)" id="view-role-select">
        <option value="admin">ç®¡ç†è€… â€” å…¨ç¨®åˆ¥é–²è¦§å¯</option>
        <option value="provide">æä¾›æ‹…å½“è€… â€” æä¾›ç”¨ãƒ»å‘¨çŸ¥ç­‰ç”¨ã®ã¿</option>
        <option value="public">å¤–éƒ¨äº‹æ¥­è€… â€” å‘¨çŸ¥ç­‰ç”¨ã®ã¿</option>
      </select>
      <span id="view-role-badge" class="badge-role role-admin badge">ADMIN</span>
    </div>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒ¼ -->
    <div class="filter-bar">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="search-input" placeholder="ä»¶åãƒ»æ¦‚è¦ãƒ»IOCã§æ¤œç´¢..." oninput="applyFilters()">
      </div>
      <span class="filter-label">ç¨®åˆ¥:</span>
      <select class="filter-select" id="filter-category" onchange="applyFilters()">
        <option value="">ã™ã¹ã¦</option>
        <option value="c1">ç·åˆæ•´ç†åˆ†ææƒ…å ±</option>
        <option value="c2">æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</option>
        <option value="c3">å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</option>
      </select>
      <span class="filter-label">è„…å¨:</span>
      <select class="filter-select" id="filter-threat" onchange="applyFilters()">
        <option value="">ã™ã¹ã¦</option>
        <option value="critical">ğŸ”´ é‡å¤§</option>
        <option value="high">ğŸŸ  é«˜</option>
        <option value="medium">ğŸŸ¡ ä¸­</option>
        <option value="low">ğŸŸ¢ ä½</option>
      </select>
      <button class="btn btn-secondary btn-sm" onclick="clearFilters()">ã‚¯ãƒªã‚¢</button>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th onclick="sortBy('id')">ç®¡ç†ç•ªå· â†•</th>
            <th onclick="sortBy('title')">ä»¶å â†•</th>
            <th onclick="sortBy('category')">ç¨®åˆ¥ â†•</th>
            <th onclick="sortBy('threat')">è„…å¨ãƒ¬ãƒ™ãƒ« â†•</th>
            <th onclick="sortBy('attack')">æ”»æ’ƒç¨®åˆ¥</th>
            <th onclick="sortBy('date')">ç™ºç”Ÿæ—¥ â†•</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="list-tbody"></tbody>
      </table>
      <div class="pagination">
        <div id="page-info">0 ä»¶</div>
        <div class="page-btns" id="page-btns"></div>
      </div>
    </div>
  </div>

  <!-- ===== ACCESS CONTROL ===== -->
  <div class="page" id="page-access">
    <div class="section-header">
      <div class="section-title">ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ»æä¾›ç¯„å›²</div>
    </div>
    <div class="access-grid">
      <div class="access-card">
        <div class="access-card-header ach-c1">ğŸ”µ ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
        <div class="access-card-body">
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>è¡Œæ”¿æ©Ÿé–¢ç­‰</strong> â€” å¯¾ç­–ãƒ»æªç½®ã«å¿…è¦ãªæƒ…å ±</span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>å¤–å›½ã®æ”¿åºœãƒ»æ©Ÿé–¢</strong> â€” å€‹åˆ¥åˆ¤æ–­ãƒ»ç¢ºèªå¾Œ</span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>å”è­°ä¼šæ§‹æˆå“¡</strong> â€” æŠ€è¡“æƒ…å ±ãƒ»çµŒå–¶å±¤å‘ã‘æƒ…å ±</span>
          </div>
          <div class="access-rule">
            <span class="access-deny">âœ—</span>
            <span style="color:var(--text-light)">ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ï¼ˆä¸€èˆ¬ï¼‰</span>
          </div>
          <div class="access-rule">
            <span class="access-deny">âœ—</span>
            <span style="color:var(--text-light)">é›»å­è¨ˆç®—æ©Ÿä½¿ç”¨è€…ï¼ˆä¸€èˆ¬ï¼‰</span>
          </div>
          <div style="margin-top:10px;padding-top:10px;border-top:1px solid var(--border);">
            <div style="font-size:11px;color:var(--text-light);line-height:1.5;">
              âš ï¸ é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ã‚’å«ã‚€ã€‚å®‰å…¨ç®¡ç†æªç½®å¿…é ˆã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚¯ãƒªã‚¢ãƒ©ãƒ³ã‚¹åˆ¶åº¦ã®æ´»ç”¨ã‚’æƒ³å®šã€‚
            </div>
          </div>
        </div>
      </div>
      <div class="access-card">
        <div class="access-card-header ach-c2">ğŸŸ¢ æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
        <div class="access-card-body">
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>è¡Œæ”¿æ©Ÿé–¢ç­‰</strong></span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>å”è­°ä¼šæ§‹æˆå“¡</strong></span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…</strong> â€” æ‰€ç®¡çœåºçµŒç”±</span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>é›»å­è¨ˆç®—æ©Ÿç­‰ä¾›çµ¦è€…</strong> â€” è„†å¼±æ€§æƒ…å ±ç­‰</span>
          </div>
          <div class="access-rule">
            <span class="access-deny">âœ—</span>
            <span style="color:var(--text-light)">é›»å­è¨ˆç®—æ©Ÿä½¿ç”¨è€…ï¼ˆä¸€èˆ¬ï¼‰</span>
          </div>
          <div style="margin-top:10px;padding-top:10px;border-top:1px solid var(--border);">
            <div style="font-size:11px;color:var(--text-light);line-height:1.5;">
              â„¹ï¸ é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ã‚’å«ã¾ãªã„ã€‚ç§˜å¯†æƒ…å ±ã‚’å«ã‚€å ´åˆã‚ã‚Šã€‚æƒ…å ±å–æ‰±è€…ã®ç‰¹å®šç­‰ã®å®‰å…¨ç®¡ç†æªç½®ã‚’å®Ÿæ–½ã€‚
            </div>
          </div>
        </div>
      </div>
      <div class="access-card">
        <div class="access-card-header ach-c3">ğŸŸ£ å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
        <div class="access-card-body">
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>è¡Œæ”¿æ©Ÿé–¢ç­‰</strong></span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…</strong></span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>é›»å­è¨ˆç®—æ©Ÿä½¿ç”¨è€…</strong> â€” ä¸€èˆ¬äº‹æ¥­è€…å«ã‚€</span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>é›»å­è¨ˆç®—æ©Ÿç­‰ä¾›çµ¦è€…</strong></span>
          </div>
          <div class="access-rule">
            <span class="access-allow">âœ“</span>
            <span><strong>ä¸€èˆ¬ï¼ˆå…¬è¡¨ãƒ»å‘¨çŸ¥ï¼‰</strong></span>
          </div>
          <div style="margin-top:10px;padding-top:10px;border-top:1px solid var(--border);">
            <div style="font-size:11px;color:var(--text-light);line-height:1.5;">
              âœ… ç§˜å¯†ã‚’å«ã¾ãªã„ã€‚æ”»æ’ƒæŠ€è¡“æƒ…å ±ç­‰ã‚’åºƒãå‘¨çŸ¥ãƒ»æ³¨æ„å–šèµ·ã™ã‚‹ãŸã‚ã«æ´»ç”¨ã€‚å§”è¨—äº‹å‹™ã®å¯¾è±¡ã¨ãªã‚Šå¾—ã‚‹ã€‚
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æä¾›ãƒ•ãƒ­ãƒ¼å›³ -->
    <div class="section-header" style="margin-top:8px;">
      <div class="section-title">æƒ…å ±åŠ å·¥ãƒ»æä¾›ãƒ•ãƒ­ãƒ¼</div>
    </div>
    <div class="form-card">
      <div class="form-body" style="padding: 22px 28px;">
        <div style="display:flex;align-items:center;gap:0;flex-wrap:wrap;justify-content:center;">
          <div style="text-align:center;padding:14px 18px;background:var(--c1-bg);border:2px solid var(--c1);border-radius:8px;min-width:150px;">
            <div style="font-size:11px;font-weight:700;color:var(--c1);margin-bottom:4px;">â‘  åé›†æƒ…å ±</div>
            <div style="font-size:11px;color:var(--text-light)">é€šä¿¡æƒ…å ±ãƒ»å ±å‘Šæƒ…å ±ãƒ»<br>ãã®ä»–æ‰‹æ³•å–å¾—æƒ…å ±</div>
          </div>
          <div style="font-size:22px;color:var(--text-light);padding:0 12px;">â†’</div>
          <div style="text-align:center;padding:14px 18px;background:var(--c1-bg);border:2px solid var(--c1);border-radius:8px;min-width:160px;">
            <div style="font-size:11px;font-weight:700;color:var(--c1);margin-bottom:4px;">â‘¡ ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
            <div style="font-size:11px;color:var(--text-light)">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒ–ãƒ»ç…§åˆãƒ»<br>ç·åˆçš„æ•´ç†åˆ†æ</div>
          </div>
          <div style="font-size:22px;color:var(--text-light);padding:0 12px;">â†’</div>
          <div style="text-align:center;padding:14px 18px;background:var(--c2-bg);border:2px solid var(--c2);border-radius:8px;min-width:160px;">
            <div style="font-size:11px;font-weight:700;color:var(--c2);margin-bottom:4px;">â‘¢ æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
            <div style="font-size:11px;color:var(--text-light)">é€šä¿¡æƒ…å ±ã‚’é™¤å¤–ã—ãŸ<br>åŠ å·¥ï¼ˆç§˜å¯†å«ã‚€å¯ï¼‰</div>
          </div>
          <div style="font-size:22px;color:var(--text-light);padding:0 12px;">â†’</div>
          <div style="text-align:center;padding:14px 18px;background:var(--c3-bg);border:2px solid var(--c3);border-radius:8px;min-width:160px;">
            <div style="font-size:11px;font-weight:700;color:var(--c3);margin-bottom:4px;">â‘£ å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</div>
            <div style="font-size:11px;color:var(--text-light)">ç§˜å¯†ã‚’å®Œå…¨ã«é™¤å¤–ã—ãŸ<br>åºƒå ±ãƒ»å‘¨çŸ¥å‘ã‘åŠ å·¥</div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div><!-- /main-content -->

<!-- ===== DETAIL MODAL ===== -->
<div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
  <div class="modal" id="modal">
    <div class="modal-header" id="modal-header">
      <div>
        <div id="modal-badge"></div>
        <div style="font-size:15px;font-weight:700;margin-top:6px;" id="modal-title"></div>
      </div>
      <button class="modal-close" onclick="closeModalDirect()">Ã—</button>
    </div>
    <div class="modal-body" id="modal-body"></div>
  </div>
</div>

<!-- ===== TOAST ===== -->
<div class="toast" id="toast"></div>

<script>
// ===== DATA STORE =====
let records = [];
let selectedCategory = null;
let currentPage = 1;
const PER_PAGE = 10;
let sortKey = 'id';
let sortDir = 1;
let viewRole = 'admin';

// ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
const sampleData = [
  {
    id: 'CAO-2025-001',
    title: 'é›»åŠ›ã‚¤ãƒ³ãƒ•ãƒ©ã¸ã®APTæ”»æ’ƒã«é–¢ã™ã‚‹TTPæƒ…å ±',
    source: 'é€šä¿¡æƒ…å ±ãƒ»åŒç›Ÿå›½å…±æœ‰æƒ…å ±',
    threat: 'critical',
    attack: 'apt',
    sector: 'é›»åŠ›ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼',
    date: '2025-11-15',
    summary: 'å›½å®¶ã‚’èƒŒæ™¯ã¨ã™ã‚‹ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã‚°ãƒ«ãƒ¼ãƒ—ãŒã€é›»åŠ›åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¨™çš„ã¨ã—ãŸã‚¹ãƒ”ã‚¢ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚’å®Ÿæ–½ã€‚è¤‡æ•°ã®ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ã§ä¸å¯©ãªé€šä¿¡ã‚’æ¤œçŸ¥ã€‚ä¾µå®³ã®ç—•è·¡ï¼ˆIOCï¼‰ãŠã‚ˆã³æ”»æ’ƒæˆ¦è¡“ãƒ»æŠ€è¡“ãƒ»æ‰‹é †ï¼ˆTTPï¼‰ã‚’æ•´ç†ã€‚',
    ioc: '*.evil-infra[.]ru, 185.220.101.x, SHA256: a1b2c3d4e5f6... (CVE-2025-1234)',
    countermeasure: 'VPNæ©Ÿå™¨ã®è„†å¼±æ€§ãƒ‘ãƒƒãƒé©ç”¨ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ¤œçŸ¥å¼·åŒ–ã€SOCã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«æ›´æ–°',
    memoC1: 'é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±ï¼ˆå‚å—ã—ãŸé€šä¿¡ãƒ‘ã‚±ãƒƒãƒˆã®é€å—ä¿¡å…ƒIPãƒ­ã‚°å…¨ä»¶ï¼‰ã‚’é™¤å¤–ã€‚\nåŒç›Ÿå›½å…±æœ‰æƒ…å ±ã«å«ã¾ã‚Œã‚‹æ”»æ’ƒã‚°ãƒ«ãƒ¼ãƒ—ã®å®Ÿåãƒ»çµ„ç¹”åã‚’ã€Œå›½å®¶æ”¯æ´å‹ã‚°ãƒ«ãƒ¼ãƒ—Aã€ã«æŠ½è±¡åŒ–ã€‚\nä¾µå®³ç¢ºèªæ¸ˆã¿é›»åŠ›äº‹æ¥­è€…åã‚’ã€Œç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ï¼ˆé›»åŠ›åˆ†é‡ï¼‰è¤‡æ•°ç¤¾ã€ã«å¤‰æ›´ã€‚',
    memoC2: 'æä¾›ç”¨ã‹ã‚‰æ®‹å­˜ã—ã¦ã„ãŸæ”»æ’ƒã‚¤ãƒ³ãƒ•ãƒ©ã®è©³ç´°ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒªã‚¹ãƒˆï¼ˆ185.220.101.x å…¨ãƒ¬ãƒ³ã‚¸ï¼‰ã‚’å‰Šé™¤ã€‚\nCVEç•ªå·ã¯ãã®ã¾ã¾æ®‹å­˜ï¼ˆå…¬é–‹æƒ…å ±ã®ãŸã‚ï¼‰ã€‚\nã€Œã€‡ã€‡çœã®åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã€â†’ã€Œé›»åŠ›ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†é‡ã®é‡è¦ã‚¤ãƒ³ãƒ•ãƒ©å…¨èˆ¬ã¸ã®æ³¨æ„å–šèµ·ã€ã«å¤‰æ›´ã€‚\nçµŒå–¶å±¤å‘ã‘ã«ã€Œæ”»æ’ƒã®èƒŒæ™¯ãƒ»ç›®çš„ã€ã®è¨˜è¿°ã‚’è¿½åŠ ã€‚',
    category: 'c1',
    registered: '2025-11-16'
  },
  {
    id: 'CAO-2025-002',
    title: 'é‡‘èæ©Ÿé–¢ã‚’æ¨™çš„ã¨ã—ãŸãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢æ”»æ’ƒæ³¨æ„å–šèµ·',
    source: 'ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…å ±å‘Šãƒ»NISC',
    threat: 'high',
    attack: 'ransomware',
    sector: 'é‡‘èãƒ»ä¿é™º',
    date: '2025-11-20',
    summary: 'å›½å†…è¤‡æ•°ã®é‡‘èæ©Ÿé–¢ã«ãŠã„ã¦LockBitã®äºœç¨®ã¨ã•ã‚Œã‚‹ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢ã¸ã®æ„ŸæŸ“ãŒç¢ºèªã•ã‚ŒãŸã€‚æ”»æ’ƒè€…ã¯ VPNè„†å¼±æ€§ã‚’çµŒç”±ã—ã¦ä¾µå…¥ã—ã€æ¨ªå±•é–‹å¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–ã€‚æ¥­å‹™ç¶™ç¶šã«å½±éŸ¿ãŒç”Ÿã˜ã¦ã„ã‚‹ã€‚',
    ioc: 'CVE-2024-3400, 192.168.x.x (C2: ransomware-c2[.]onion)',
    countermeasure: 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ç¢ºèªã€VPNå³æ™‚ãƒ‘ãƒƒãƒé©ç”¨ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢ã®æ¤œè¨',
    memoC1: 'ç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ï¼ˆé‡‘è2ç¤¾ï¼‰ã®ç¤¾åãƒ»è¢«å®³é‡‘é¡ãƒ»æ¥­å‹™åœæ­¢æ™‚é–“ã®å…·ä½“å€¤ã‚’é™¤å¤–ã€‚\né€šä¿¡æƒ…å ±ç”±æ¥ã®C2ã‚µãƒ¼ãƒãƒ¼é€šä¿¡ãƒ­ã‚°è©³ç´°ã‚’å‰Šé™¤ã€‚\nãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼åï¼ˆå…¬çŸ¥æƒ…å ±ï¼‰ã¯ãã®ã¾ã¾è¨˜è¼‰ã€‚',
    memoC2: '',
    category: 'c2',
    registered: '2025-11-21'
  },
  {
    id: 'CAO-2025-003',
    title: 'é‡è¦ã‚¤ãƒ³ãƒ•ãƒ©å‘ã‘ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒæ³¨æ„å–šèµ·ï¼ˆä¸€èˆ¬å…¬é–‹ç‰ˆï¼‰',
    source: 'æ•´ç†åˆ†æçµæœï¼ˆåŠ å·¥æ¸ˆã¿ï¼‰',
    threat: 'medium',
    attack: 'phishing',
    sector: 'å…¨æ¥­ç¨®',
    date: '2025-11-25',
    summary: 'è¿‘æ™‚ã€æ¨™çš„å‹ãƒ¡ãƒ¼ãƒ«ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°æ”»æ’ƒãŒå¢—åŠ å‚¾å‘ã«ã‚ã‚Šã¾ã™ã€‚æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®é–‹å°ã‚„ãƒªãƒ³ã‚¯ã®ã‚¯ãƒªãƒƒã‚¯ã«ååˆ†ã”æ³¨æ„ãã ã•ã„ã€‚ä¸å¯©ãªãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸå ´åˆã¯ã€æ‰€ç®¡çœåºãƒ»æƒ…å ±å‡¦ç†æ¨é€²æ©Ÿæ§‹ï¼ˆIPAï¼‰ã¸ã”é€£çµ¡ãã ã•ã„ã€‚',
    ioc: 'ï¼ˆçœç•¥ï¼‰',
    countermeasure: 'ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®å¼·åŒ–ã€å¾“æ¥­å“¡ã¸ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ•™è‚²ã®å®Ÿæ–½',
    memoC1: 'å…ƒã®ç·åˆæ•´ç†åˆ†ææƒ…å ±ã‹ã‚‰é€šä¿¡å‚å—æƒ…å ±ãƒ»æ©Ÿå¯†æƒ…å ±ã‚’ã™ã¹ã¦é™¤å¤–æ¸ˆã¿ã€‚\næä¾›ç”¨ã§ã¯æ”»æ’ƒè€…ã«é–¢ã™ã‚‹æƒ…å ±ã‚’ã€Œä¸ç‰¹å®šã®æ”»æ’ƒã‚°ãƒ«ãƒ¼ãƒ—ã€ã¨è¨˜è¼‰ã€‚',
    memoC2: 'å…·ä½“çš„ãªãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°URLãƒ»é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰Šé™¤ï¼ˆç‰¹å®šã®çµ„ç¹”ãŒæ¨™çš„ã§ã‚ã‚‹ã“ã¨ãŒæ¨æ¸¬ã•ã‚Œã‚‹ãŸã‚ï¼‰ã€‚\nã€ŒIPAã¸å ±å‘Šã‚’ã€ã¨ã„ã†è¡Œå‹•å–šèµ·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã€‚ä¸€èˆ¬å‘ã‘ã®å¹³æ˜“ãªæ–‡ä½“ã«å¤‰æ›´ã€‚',
    category: 'c3',
    registered: '2025-11-26'
  }
];
records = [...sampleData];

// ===== NAV =====
function showPage(name) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  document.getElementById('nav-' + name).classList.add('active');
  if (name === 'dashboard') renderDashboard();
  if (name === 'list') renderList();
  updateCounts();
}

// ===== CATEGORY SELECT =====
function selectCategory(cat) {
  selectedCategory = cat;
  ['c1','c2','c3'].forEach(c => {
    document.getElementById('catbtn-' + c).className = 'cat-btn ' + c;
  });
  document.getElementById('catbtn-' + cat).classList.add('selected-' + cat);

  const ind = document.getElementById('cat-indicator');
  const labels = {
    c1: 'ğŸ”µ ç·åˆæ•´ç†åˆ†ææƒ…å ±ï¼ˆç§˜åŒ¿æ€§é«˜ â€” é¸åˆ¥å¾Œé€šä¿¡æƒ…å ±å«ã‚€ï¼‰',
    c2: 'ğŸŸ¢ æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±ï¼ˆé€šä¿¡æƒ…å ±é™¤å¤– â€” ç§˜å¯†å«ã‚€å¯ï¼‰',
    c3: 'ğŸŸ£ å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±ï¼ˆç§˜å¯†ãªã— â€” åºƒãå‘¨çŸ¥å¯¾è±¡ï¼‰'
  };
  ind.className = 'classification-indicator ci-' + cat;
  ind.textContent = labels[cat];
}

// ===== FORM SUBMIT =====
function submitForm() {
  const title = document.getElementById('f-title').value.trim();
  const summary = document.getElementById('f-summary').value.trim();
  const threat = document.getElementById('f-threat').value;
  if (!title) { showToast('ä»¶åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error'); return; }
  if (!summary) { showToast('æ¦‚è¦ãƒ»è©³ç´°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error'); return; }
  if (!threat) { showToast('è„…å¨ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error'); return; }
  if (!selectedCategory) { showToast('æƒ…å ±ç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error'); return; }

  const today = new Date().toISOString().slice(0,10);
  const id = 'CAO-' + new Date().getFullYear() + '-' + String(records.length + 1).padStart(3,'0');
  records.unshift({
    id,
    title,
    source: document.getElementById('f-source').value.trim() || 'â€”',
    threat,
    attack: document.getElementById('f-attack').value || 'â€”',
    sector: document.getElementById('f-sector').value.trim() || 'â€”',
    date: document.getElementById('f-date').value || today,
    summary,
    ioc: document.getElementById('f-ioc').value.trim() || 'â€”',
    countermeasure: document.getElementById('f-countermeasure').value.trim() || 'â€”',
    memoC1: document.getElementById('f-memo-c1').value.trim() || '',
    memoC2: document.getElementById('f-memo-c2').value.trim() || '',
    category: selectedCategory,
    registered: today
  });
  updateCounts();
  showToast('âœ… æƒ…å ±ã‚’ç™»éŒ²ã—ã¾ã—ãŸ: ' + id, 'success');
  resetForm();
  setTimeout(() => showPage('list'), 800);
}

function resetForm() {
  ['f-title','f-source','f-sector','f-summary','f-ioc','f-countermeasure','f-memo-c1','f-memo-c2'].forEach(id => {
    document.getElementById(id).value = '';
  });
  document.getElementById('f-threat').value = '';
  document.getElementById('f-attack').value = '';
  document.getElementById('f-date').value = '';
  selectedCategory = null;
  ['c1','c2','c3'].forEach(c => {
    document.getElementById('catbtn-' + c).className = 'cat-btn ' + c;
  });
  const ind = document.getElementById('cat-indicator');
  ind.className = 'classification-indicator ci-none';
  ind.textContent = 'â† ç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„';
}

// ===== COUNTS =====
function updateCounts() {
  const total = records.length;
  const c1 = records.filter(r=>r.category==='c1').length;
  const c2 = records.filter(r=>r.category==='c2').length;
  const c3 = records.filter(r=>r.category==='c3').length;
  document.getElementById('stat-total').textContent = total;
  document.getElementById('stat-c1').textContent = c1;
  document.getElementById('stat-c2').textContent = c2;
  document.getElementById('stat-c3').textContent = c3;
  document.getElementById('count-badge').textContent = total;
}

// ===== DASHBOARD =====
function renderDashboard() {
  const tbody = document.getElementById('dashboard-tbody');
  const rows = records.slice(0,5);
  if (!rows.length) {
    tbody.innerHTML = '<tr><td colspan="5" class="no-data">ç™»éŒ²æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
    return;
  }
  tbody.innerHTML = rows.map(r => `
    <tr>
      <td><span style="font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--text-mid);">${r.id}</span></td>
      <td style="max-width:260px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${r.title}</td>
      <td>${badgeHTML(r.category)}</td>
      <td>${threatHTML(r.threat)}</td>
      <td><span style="font-size:12px;color:var(--text-mid);">${r.date}</span></td>
    </tr>`).join('');
}

// ===== LIST =====
let filteredRecords = [];
function getVisibleCategories() {
  if (viewRole === 'admin') return ['c1','c2','c3'];
  if (viewRole === 'provide') return ['c2','c3'];
  return ['c3'];
}
function applyFilters() {
  const q = document.getElementById('search-input').value.toLowerCase();
  const cat = document.getElementById('filter-category').value;
  const threat = document.getElementById('filter-threat').value;
  const allowed = getVisibleCategories();

  filteredRecords = records.filter(r => {
    if (!allowed.includes(r.category)) return false;
    if (cat && r.category !== cat) return false;
    if (threat && r.threat !== threat) return false;
    if (q && !(
      r.title.toLowerCase().includes(q) ||
      r.summary.toLowerCase().includes(q) ||
      (r.ioc||'').toLowerCase().includes(q) ||
      r.id.toLowerCase().includes(q)
    )) return false;
    return true;
  });
  // sort
  filteredRecords.sort((a,b) => {
    let av = a[sortKey]||'', bv = b[sortKey]||'';
    return av < bv ? -sortDir : av > bv ? sortDir : 0;
  });
  currentPage = 1;
  renderListTable();
}
function clearFilters() {
  document.getElementById('search-input').value = '';
  document.getElementById('filter-category').value = '';
  document.getElementById('filter-threat').value = '';
  applyFilters();
}
function sortBy(key) {
  if (sortKey === key) sortDir = -sortDir;
  else { sortKey = key; sortDir = 1; }
  applyFilters();
}
function renderList() { applyFilters(); }
function renderListTable() {
  const tbody = document.getElementById('list-tbody');
  const total = filteredRecords.length;
  const totalPages = Math.max(1, Math.ceil(total / PER_PAGE));
  if (currentPage > totalPages) currentPage = totalPages;
  const slice = filteredRecords.slice((currentPage-1)*PER_PAGE, currentPage*PER_PAGE);

  if (!slice.length) {
    tbody.innerHTML = '<tr><td colspan="7" class="no-data">è©²å½“ã™ã‚‹æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“<br><span style="font-size:11px;color:var(--text-light);">é–²è¦§æ¨©é™ã¾ãŸã¯æ¤œç´¢æ¡ä»¶ã‚’ã”ç¢ºèªãã ã•ã„</span></td></tr>';
  } else {
    tbody.innerHTML = slice.map(r => `
      <tr>
        <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--text-mid);">${r.id}</span></td>
        <td style="max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:500;">${r.title}</td>
        <td>${badgeHTML(r.category)}</td>
        <td>${threatHTML(r.threat)}</td>
        <td><span style="font-size:12px;">${attackLabel(r.attack)}</span></td>
        <td><span style="font-size:12px;color:var(--text-mid);">${r.date}</span></td>
        <td>
          <button class="btn btn-secondary btn-sm" onclick="openDetail('${r.id}')">è©³ç´°</button>
          <button class="btn btn-danger btn-sm" onclick="deleteRecord('${r.id}')" style="margin-left:4px;">å‰Šé™¤</button>
        </td>
      </tr>`).join('');
  }

  document.getElementById('page-info').textContent = total + ' ä»¶ä¸­ ' + ((currentPage-1)*PER_PAGE+1) + 'â€“' + Math.min(currentPage*PER_PAGE, total) + ' ä»¶è¡¨ç¤º';

  // pagination
  const pb = document.getElementById('page-btns');
  pb.innerHTML = '';
  for (let i=1; i<=totalPages; i++) {
    const b = document.createElement('button');
    b.className = 'page-btn' + (i===currentPage?' active':'');
    b.textContent = i;
    b.onclick = (p => () => { currentPage=p; renderListTable(); })(i);
    pb.appendChild(b);
  }
}

// ===== DETAIL MODAL =====
function openDetail(id) {
  const r = records.find(x=>x.id===id);
  if (!r) return;
  const catLabels = {c1:'ç·åˆæ•´ç†åˆ†ææƒ…å ±',c2:'æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±',c3:'å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±'};
  const catColors = {c1:'var(--c1)',c2:'var(--c2)',c3:'var(--c3)'};
  document.getElementById('modal-header').style.background = catColors[r.category];
  document.getElementById('modal-badge').innerHTML = badgeHTML(r.category);
  document.getElementById('modal-title').textContent = r.title;
  document.getElementById('modal-body').innerHTML = `
    <div class="detail-row"><div class="detail-key">ç®¡ç†ç•ªå·</div><div class="detail-val" style="font-family:'IBM Plex Mono',monospace;">${r.id}</div></div>
    <div class="detail-row"><div class="detail-key">æƒ…å ±ç¨®åˆ¥</div><div class="detail-val">${catLabels[r.category]}</div></div>
    <div class="detail-row"><div class="detail-key">è„…å¨ãƒ¬ãƒ™ãƒ«</div><div class="detail-val">${threatHTML(r.threat)}</div></div>
    <div class="detail-row"><div class="detail-key">æ”»æ’ƒç¨®åˆ¥</div><div class="detail-val">${attackLabel(r.attack)}</div></div>
    <div class="detail-row"><div class="detail-key">å¯¾è±¡æ¥­ç¨®</div><div class="detail-val">${r.sector}</div></div>
    <div class="detail-row"><div class="detail-key">æƒ…å ±æº</div><div class="detail-val">${r.source}</div></div>
    <div class="detail-row"><div class="detail-key">ç™ºç”Ÿ/æ¤œçŸ¥æ—¥</div><div class="detail-val">${r.date}</div></div>
    <div class="detail-row"><div class="detail-key">ç™»éŒ²æ—¥</div><div class="detail-val">${r.registered}</div></div>
    <div class="detail-row"><div class="detail-key">æ¦‚è¦ãƒ»è©³ç´°</div><div class="detail-val" style="white-space:pre-wrap;">${r.summary}</div></div>
    <div class="detail-row"><div class="detail-key">IOC</div><div class="detail-val" style="font-family:'IBM Plex Mono',monospace;font-size:12px;">${r.ioc}</div></div>
    <div class="detail-row"><div class="detail-key">æ¨å¥¨å¯¾ç­–</div><div class="detail-val">${r.countermeasure}</div></div>
    <div class="detail-row" style="flex-direction:column;gap:10px;">
      <div class="detail-key" style="flex:none;">
        <div class="memo-section-title">âœ‚ï¸ åŠ å·¥å±¥æ­´ï¼ˆæƒ…å ±ç¨®åˆ¥ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã®è¨˜éŒ²ï¼‰</div>
      </div>
      <div class="detail-val" style="flex:none;">
        <div class="process-timeline">
          <div class="process-step">
            <div class="process-dot dot-c1"></div>
            <div class="process-step-header">
              <span class="badge badge-c1">ğŸ”µ ç·åˆæ•´ç†åˆ†ææƒ…å ±</span>
              <span class="process-step-date">ï¼ˆåŸæœ¬ï¼‰</span>
            </div>
            ${r.memoC1
              ? `<div class="process-memo memo-c1">â–¼ æä¾›ç”¨ã¸ã®åŠ å·¥å†…å®¹ï¼š\n${r.memoC1}</div>`
              : (r.category === 'c1'
                  ? '<div class="process-pending">â€» ã“ã®æƒ…å ±ã¯ç·åˆæ•´ç†åˆ†ææƒ…å ±ã¨ã—ã¦ç®¡ç†ä¸­ã€‚åŠ å·¥æœªå®Ÿæ–½ã€‚</div>'
                  : '<div class="process-memo memo-c1" style="color:var(--text-light);">ï¼ˆåŠ å·¥ãƒ¡ãƒ¢æœªè¨˜å…¥ï¼‰</div>')}
          </div>
          <div class="process-step">
            <div class="process-dot ${r.category==='c1' ? 'dot-pending' : 'dot-c2'}"></div>
            <div class="process-step-header">
              <span class="badge ${r.category==='c1' ? '' : 'badge-c2'}" style="${r.category==='c1' ? 'background:#eee;color:#999;border:1px solid #ddd;' : ''}">ğŸŸ¢ æä¾›ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</span>
              ${r.category==='c1' ? '<span class="process-step-date">æœªåŠ å·¥</span>' : ''}
            </div>
            ${r.category === 'c1'
              ? '<div class="process-pending">â³ æä¾›ç”¨ã¸ã®åŠ å·¥ãŒå¿…è¦ã§ã™ã€‚</div>'
              : (r.memoC2
                  ? `<div class="process-memo memo-c2">â–¼ å‘¨çŸ¥ç­‰ç”¨ã¸ã®åŠ å·¥å†…å®¹ï¼š\n${r.memoC2}</div>`
                  : (r.category === 'c2'
                      ? '<div class="process-pending">â€» ã“ã®æƒ…å ±ã¯æä¾›ç”¨ã¨ã—ã¦ç®¡ç†ä¸­ã€‚å‘¨çŸ¥ç­‰ç”¨ã¸ã®åŠ å·¥æœªå®Ÿæ–½ã€‚</div>'
                      : '<div class="process-memo memo-c2" style="color:var(--text-light);">ï¼ˆåŠ å·¥ãƒ¡ãƒ¢æœªè¨˜å…¥ï¼‰</div>'))}
          </div>
          <div class="process-step">
            <div class="process-dot ${r.category==='c3' ? 'dot-c3' : 'dot-pending'}"></div>
            <div class="process-step-header">
              <span class="badge ${r.category==='c3' ? 'badge-c3' : ''}" style="${r.category!=='c3' ? 'background:#eee;color:#999;border:1px solid #ddd;' : ''}">ğŸŸ£ å‘¨çŸ¥ç­‰ç”¨ç·åˆæ•´ç†åˆ†ææƒ…å ±</span>
              ${r.category!=='c3' ? '<span class="process-step-date">æœªåŠ å·¥</span>' : '<span class="process-step-date">ï¼ˆå…¬é–‹å¯èƒ½ç‰ˆï¼‰</span>'}
            </div>
            ${r.category !== 'c3'
              ? '<div class="process-pending">â³ å‘¨çŸ¥ç­‰ç”¨ã¸ã®åŠ å·¥ãŒå¿…è¦ã§ã™ã€‚</div>'
              : '<div class="process-pending" style="color:var(--c3);font-style:normal;">âœ… ç§˜å¯†ãªã—ã€‚åºƒãäº‹æ¥­è€…ãƒ»ä¸€èˆ¬ã¸ã®å‘¨çŸ¥ãƒ»æä¾›ãŒå¯èƒ½ãªçŠ¶æ…‹ã§ã™ã€‚</div>'}
          </div>
        </div>
      </div>
    </div>
  `;
  document.getElementById('modal-overlay').classList.add('open');
}
function closeModal(e) {
  if (e.target === document.getElementById('modal-overlay')) closeModalDirect();
}
function closeModalDirect() {
  document.getElementById('modal-overlay').classList.remove('open');
}

// ===== DELETE =====
function deleteRecord(id) {
  if (!confirm('ç®¡ç†ç•ªå· ' + id + ' ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
  records = records.filter(r => r.id !== id);
  updateCounts();
  applyFilters();
  showToast('ğŸ—‘ï¸ å‰Šé™¤ã—ã¾ã—ãŸ: ' + id);
}

// ===== ROLE CHANGE =====
function changeViewRole(role) {
  viewRole = role;
  const badge = document.getElementById('view-role-badge');
  const userLabel = document.getElementById('user-label');
  const roleBadge = document.getElementById('role-badge');
  if (role==='admin') {
    badge.className = 'badge-role role-admin badge'; badge.textContent = 'ADMIN';
    userLabel.textContent = 'ç®¡ç†è€…ï¼ˆã‚µã‚¤ãƒãƒ¼å®‰å…¨ä¿éšœæ‹…å½“ï¼‰';
    roleBadge.className = 'badge-role role-admin'; roleBadge.textContent = 'ADMIN';
  } else if (role==='provide') {
    badge.className = 'badge-role role-provide badge'; badge.textContent = 'PROVIDE';
    userLabel.textContent = 'æä¾›æ‹…å½“è€…ï¼ˆæ‰€ç®¡çœåºãƒ»å”è­°ä¼šæ§‹æˆå“¡ï¼‰';
    roleBadge.className = 'badge-role role-provide'; roleBadge.textContent = 'PROVIDE';
  } else {
    badge.className = 'badge-role role-public badge'; badge.textContent = 'PUBLIC';
    userLabel.textContent = 'å¤–éƒ¨äº‹æ¥­è€…ï¼ˆç‰¹åˆ¥ç¤¾ä¼šåŸºç›¤äº‹æ¥­è€…ç­‰ï¼‰';
    roleBadge.className = 'badge-role role-public'; roleBadge.textContent = 'PUBLIC';
  }
  applyFilters();
}

// ===== HELPERS =====
function badgeHTML(cat) {
  const m = {
    c1: ['badge-c1', 'ğŸ”µ ç·åˆæ•´ç†åˆ†æ'],
    c2: ['badge-c2', 'ğŸŸ¢ æä¾›ç”¨'],
    c3: ['badge-c3', 'ğŸŸ£ å‘¨çŸ¥ç­‰ç”¨']
  };
  if (!m[cat]) return '';
  return `<span class="badge ${m[cat][0]}">${m[cat][1]}</span>`;
}
function threatHTML(t) {
  const m = {
    critical: ['threat-critical', 'é‡å¤§'],
    high:     ['threat-high', 'é«˜'],
    medium:   ['threat-medium', 'ä¸­'],
    low:      ['threat-low', 'ä½']
  };
  if (!m[t]) return 'â€”';
  return `<span class="threat-dot ${m[t][0]}"></span>${m[t][1]}`;
}
function attackLabel(a) {
  const m = {apt:'APTï¼ˆå›½å®¶æ”¯æ´å‹ï¼‰',ransomware:'ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢',ddos:'DDoS',phishing:'ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°','supply-chain':'ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³',vuln:'è„†å¼±æ€§æ‚ªç”¨',other:'ãã®ä»–','â€”':'â€”'};
  return m[a] || a || 'â€”';
}
function showToast(msg, type='') {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast' + (type?' '+type:'');
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// ===== INIT =====
updateCounts();
renderDashboard();
</script>
</body>
</html>
